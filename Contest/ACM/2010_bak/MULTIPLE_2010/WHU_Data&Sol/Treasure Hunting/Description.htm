<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=Generator content="Microsoft Word 12 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:ËÎÌå;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"\@ËÎÌå";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Calibri","sans-serif";}
h3
	{mso-style-link:"±êÌâ 3 Char";
	margin-right:0cm;
	margin-left:0cm;
	font-size:13.5pt;
	font-family:ËÎÌå;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Ò³Ã¼ Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	layout-grid-mode:char;
	border:none;
	padding:0cm;
	font-size:9.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Ò³½Å Char";
	margin:0cm;
	margin-bottom:.0001pt;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:21.0pt;
	font-size:10.5pt;
	font-family:"Calibri","sans-serif";}
span.Char
	{mso-style-name:"Ò³Ã¼ Char";
	mso-style-link:Ò³Ã¼;}
span.Char0
	{mso-style-name:"Ò³½Å Char";
	mso-style-link:Ò³½Å;}
span.3Char
	{mso-style-name:"±êÌâ 3 Char";
	mso-style-link:"±êÌâ 3";
	font-family:ËÎÌå;
	font-weight:bold;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	layout-grid:15.6pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=ZH-CN style='text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:15.6pt'>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-US
style='font-size:18.0pt;font-family:"Times New Roman","serif";color:blue'>Treasure
Hunting</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-US
style='font-size:12.0pt;font-family:"Times New Roman","serif";color:green'>Time
Limit: </span><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>2.0
Seconds<span style='color:green'>&nbsp; &nbsp;Memory Limit: </span>65536K</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>Do
you like treasure hunting? Today, with one of his friend, iSea is on a venture
trip again. As most movie said, they find so many gold hiding in their trip.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>Now
iSea¡¯s clever friend has already got the map of the place they are going to
hunt, simplify the map, there are three ground types:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>¡®.¡¯
means blank ground, they can get through it</span></li>
 <li class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>¡®#¡¯
     means block, they can¡¯t get through it</span></li>
 <li class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>¡®*¡¯
     means gold hiding under ground, also they can just get through it (but you
     won¡¯t, right?)</span></li>
</ul>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>What
makes iSea very delighted is the friend with him is extraordinary justice, he
would not take away things which doesn¡¯t belong to him, so all the treasure belong
to iSea oneself! </span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>But
his friend has a request, he will set up a number of rally points on the map,
namely 'A', 'B' ... 'Z', 'a', 'b' ... 'z' (in that order, but may be less than
52), they start in 'A', each time friend reaches to the next rally point in the
shortest way, they have to meet here (i.e. iSea reaches there earlier than or
same as his friend), then start together, but you can choose different paths.
Initially, iSea¡¯s speed is the same with his friend, but to grab treasures, he
save one time unit among each part of road, he use the only one unit to get a
treasure, after being picked, the treasure¡¯s point change into blank ground.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>Under
the premise of his friend¡¯s rule, how much treasure iSea can get at most?</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:13.5pt;font-family:
"Times New Roman","serif"'>Input</span></b></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>There
are several test cases in the input.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>Each
test case begin with two integers <i>R, C</i> (2 </span><span lang=EN-US
style='font-family:"Times New Roman","serif"'>¡Ü </span><i><span lang=EN-US
style='font-size:12.0pt;font-family:"Times New Roman","serif"'>R, C</span></i><span
lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'> </span><span
lang=EN-US style='font-family:"Times New Roman","serif"'>¡Ü </span><span
lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>100),
indicating the row number and the column number.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>Then
<i>R</i> strings follow, each string has <i>C</i> characters (must be <i>¡®A¡¯ ¨C ¡®Z¡¯</i>
or <i>¡®a¡¯ ¨C ¡®z¡¯</i> or <i>¡®.¡¯</i> or <i>¡®#¡¯</i> or <i>¡®*¡¯</i>), indicating the
type in the coordinate.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>The
input terminates by end of file marker.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:13.5pt;font-family:
"Times New Roman","serif"'>Output</span></b></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>For
each test case, output one integer, indicating maximum gold number iSea can get,
if they can¡¯t meet at one or more rally points, just output -1.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:13.5pt;font-family:
"Times New Roman","serif"'>Sample Input </span></b></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>2
4</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>A.B.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>***C</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>2
4</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>A#B.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>***C</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:13.5pt;font-family:
"Times New Roman","serif"'>Sample Output </span></b></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>1</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>2</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:13.5pt;font-family:
"Times New Roman","serif"'>Author</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:13.5pt;font-family:
"Times New Roman","serif"'>&nbsp;</span></b></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman","serif"'>iSea
@ WHU</span></p>

</div>

</body>

</html>
