降龙十八掌 

丐帮神功降龙十八掌，在北宋年间本为二十八掌，当时帮主萧峰武功盖世，却因契丹人身份遭驱除出帮，他去繁就简，将二十八掌减了十掌，成为降龙十八掌，由义弟灵鹫宫虚竹子代传，由此世代传承。到南宋末年，虽继位帮主耶律齐得岳父郭靖传授而学全，但此后丐帮历任帮主，因根柢较浅，最多也只学到十四掌为止。” 萧峰于丐帮武学的传承与发展也可说功勋卓著，除了将降龙廿八掌精简为更易传世的降龙十八掌外，在旧版《天龙八部》中萧峰使用“亢龙有悔”的地方新版都改为了“见龙在田”，而新修版《射雕英雄传》中增加了“亢龙有悔”是降龙十八掌总纲的描写，前后情节一凑，“亢龙有悔”极有可能在北宋时本无此招，是萧峰传掌时自行所创，而另一重要招数“神龙摆尾”在北宋时本来叫做“履虎尾”，虽没明确说是萧峰所改，但既然历任帮主中只写明萧峰对降龙掌大动过手术，自然也极有可能就是萧峰改创的了。降龙掌自创制掌法的那位丐帮高手起，自降龙廿八掌至萧峰精简改创为降龙十八掌传世，洪七公、郭靖先后以此掌法威震江湖，至耶律齐之后开始逐渐失传，元末时只剩十二掌，史火龙死于成昆之手后降龙十八掌极可能从此不见于世，丐帮沦落丧威至此，萧、洪地下有知，当不胜感慨。
 
身为现任丐帮帮主的洪九，听说了一个消息，在蓬莱岛上可能还存有九式降龙十八掌的掌谱。为了重振丐帮，洪九决定亲赴蓬莱探寻掌谱。据前去探路的丐帮弟子汇报，岛上有来历不明的高手把守，要成功取回掌谱绝非易事。好在洪九悟性极高，实乃练武奇才，只要他能在遇到高手阻截之前学会一招半式的降龙十八掌还是有胜算的。为了丐帮的未来，他决定冒这个险，前去一探究竟，即使只能取回部分掌谱，也能日后再图大计。
假设蓬莱岛有只有一个入口，一个出口，且当洪九坐船抵达入口后，他自己将单刀赴会，其他弟子马上将船开到出口处等待帮主，但如果之前被岛上的高手发现他们，后果将不堪设想，所以洪九必须以最快的速度抵达出口处。
现将蓬莱岛的抽象为一矩形，给出其地图信息，包括出口，入口的位置，各式掌谱及众高手的位置，请你帮忙计算下洪九是否能成功穿越重重障碍抵达出口，如果能最少需要多少步呢？ 

输入 

有多组测试数据。首先是一个正整数T（0 < T <= 10），表示测试数据的组数。
每组测试数据包括两部分：
第一部分：地图信息。首先是两个正整数R, C (0 < R,C <= 100)，表示地图的长和宽，接下来R行，每行C列为地图信息。其中“#”表示障碍物，“.”表示空地，“E”表示武林高手，“S”和“T”分别表示入口和出口，另外数字（1 ~ 9）分别表示9式掌谱。
第二部分：高手信息。每行描述一个高手，其顺序与地图中高手出现的先后顺序一致（先后序按从上到下，从左到右排）。先是一个正整数N（1 <= 9），表示这个高手需要学会N式降龙十八掌才能打败，接下来是N个正整数（大小从1到9），表示要打败这个高手具体需学会哪几式掌法。 

输出 

对每一组测试数据输出一行，如果洪九能顺利抵达出口，则输出所需的最少步数，如果到不了则输出“imposible!”。 

输入样例   
                       
2
6 6
####T#
#....#
####E#
##2E.#
#1E..#
#S####
2 1 2
2 1 3
1 1
6 6
####T#
#....#
####E#
##2E.#
#1E..#
#S####
1 1
2 1 3
2 1 2 

输出样例 

10
imposible! 

